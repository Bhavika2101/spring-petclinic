# ********RoostGPT********

# Test generated by RoostGPT for test hsbc-api-karate using AI Type Open AI and AI Model gpt-4
# 
# Feature file generated for /direct-debit-consents/{consentId}_delete for http method type DELETE 
# RoostTestHash=f37b57ea61
# 
# 

# ********RoostGPT********
Feature: API Testing for Real-time Direct Debit Consent Setup

  Background:
    * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:8080')
    * url urlBase
    * def authToken = karate.properties['AUTH_TOKEN']
    * def headers = {Authorization: '#(authToken)', 'x-fapi-auth-date': 'Sun, 10 Sep 2017 19:43:31 UTC', 'x-fapi-customer-ip-address': '169.254.169.254', 'x-fapi-interaction-id': 'abcd1234', 'Accept-Language': 'en-US'}

  Scenario Outline: Delete Consent using valid Consent ID
    Given path '/direct-debit-consents/', consentId
    And headers headers
    When method delete
    Then status 204
    And match responseHeaders['x-fapi-interaction-id'] == 'abcd1234'

    Examples:
      | consentId                                |
      | '7404e99b-1a4d-4b08-b441-c327661527f0'  |

  Scenario Outline: Delete Consent using invalid Consent ID
    Given path '/direct-debit-consents/', consentId
    And headers headers
    When method delete
    Then status 400
    And match responseHeaders['x-fapi-interaction-id'] == 'abcd1234'
    And match responseHeaders['Content-Type'] == 'application/json'
    And match responseBody.id == '#string'
    And match responseBody.errors[0].code == '#string'
    And match responseBody.errors[0].causes == '#string'
    And match responseBody.errors[0].extendedDetails.path == '#string'

    Examples:
      | consentId  |
      | 'invalid'  |

  Scenario: Delete Consent using Unauthorized token
    Given path '/direct-debit-consents/', '7404e99b-1a4d-4b08-b441-c327661527f0'
    And headers {Authorization: 'InvalidToken'}
    When method delete
    Then status 401
    And match responseHeaders['x-fapi-interaction-id'] == 'abcd1234'
    And match responseHeaders['Content-Type'] == 'application/json'
    And match responseBody == '#object'

  Scenario: Delete Consent using Forbidden token
    Given path '/direct-debit-consents/', '7404e99b-1a4d-4b08-b441-c327661527f0'
    And headers {Authorization: 'ForbiddenToken'}
    When method delete
    Then status 403
    And match responseHeaders['x-fapi-interaction-id'] == 'abcd1234'
    And match responseHeaders['Content-Type'] == 'application/json'
    And match responseBody == '#object'

  Scenario: Delete Consent using Method Not Allowed
    Given path '/direct-debit-consents/', '7404e99b-1a4d-4b08-b441-c327661527f0'
    And headers headers
    When method post
    Then status 405
    And match responseHeaders['x-fapi-interaction-id'] == 'abcd1234'
    And match responseHeaders['Content-Type'] == 'application/json'
    And match responseBody.id == '#string'
    And match responseBody.errors[0].code == '#string'
    And match responseBody.errors[0].causes == '#string'
    And match responseBody.errors[0].extendedDetails.path == '#string'
